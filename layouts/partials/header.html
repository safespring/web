<header id="navbar" class="site-header">
  <div class="site-header-wrapper">
    <div class="site-header-logo">
      <a
        href="/"
      >
        <img
          src="/img/logos/safespring_logotype_blue_svg.svg"
          width="140"
          height="30"
          alt="Safespring logotype"
        />
      </a>
    </div>
    <nav class="site-header-nav">
      <div id="menuToggle">
        <input id="menuCheckbox" aria-label="Safespring menu" type="checkbox" />
        <span></span>
        <span></span>
        <span></span>
        <ul id="menu" class="site-header-links">
          <li>
            <a
              id="main-menu-link-platform"
              style="padding-bottom: 30px; margin-bottom: -30px"
              href="{{ with .GetPage "services" }}{{ .RelPermalink }}{{ end }}"
              >{{ T "topnav.platform" }}</a
            >
          </li>
          <li>
            <a
              id="main-menu-link-1"
              href="{{ with .GetPage "price" }}{{ .RelPermalink }}{{ end }}"
              >{{ T "topnav.price" }}</a
            >
          </li>
          <li>
            <a id="main-menu-link-2" href="{{ with .GetPage "knowledge-hub" }}{{ .RelPermalink }}{{ end }}"
              >{{ T "topnav.news" }}</a
            >
          </li>
          <li>
            <a
              id="main-menu-link-3"
              href="{{ with .GetPage "contact" }}{{ .RelPermalink }}{{ end }}"
              >{{ T "topnav.contact" }}</a
            >
          </li>
          <li>
            <a
              id="main-menu-link-5"
              href="mailto:hello@safespring.com"
              class="site-header-button-mail"
              onclick="_paq.push(['trackEvent', 'Knapptryck', 'Mailknapp']);"
              >hello@safespring.com</a
            >
          </li>
        </ul>
      </div>
    </nav>
  </div>
  <div class="megamenu-wrapper">
    <div class="megamenu-main-service">
      {{ range (where $.Site.RegularPages "Section"
        "services").ByParam "cardorder"
      }}
        {{ if isset .Params "megamenu" }}{{ .Render "li-megamenu" }}{{ end }}
      {{ end }}
    </div>
    <div class="megamenu-service-card">
      <span class="megamenu-service-card-title-small">{{ T "topnav.built_on_safespring" }}</span>
      <ul class="megamenu-service-card-list">
        {{ range (where $.Site.RegularPages "Section" "services").ByParam
          "cardorder"
        }}
          {{ if and (not (isset .Params "megamenu")) (isset .Params
            "cardorder")
          }}
            <li>
              <a href="{{ .RelPermalink }}" class="matomo-track"
                >{{ .Params.cardtitle }}</a
              >
            </li>
          {{ end }}
        {{ end }}
      </ul>
    </div>
  </div>
</header>
<script>
  var prevScrollpos = window.pageYOffset;
  window.onscroll = function () {
    var currentScrollPos = window.pageYOffset;
    if (prevScrollpos > currentScrollPos || currentScrollPos < 120) {
      document.getElementById("navbar").style.top = "0px";
    } else {
      document.getElementById("navbar").style.top = "-200px";
    }
    prevScrollpos = currentScrollPos;
  };
</script>
<script>
  let platformLink = document.getElementById("main-menu-link-platform");
  let megaMenuWrapper = document.querySelector(".megamenu-wrapper");
  let hideTimeout;

  platformLink.addEventListener("mouseover", function () {
    clearTimeout(hideTimeout);
    megaMenuWrapper.classList.add("show");
  });

  function handleMouseOut() {
    hideTimeout = setTimeout(function () {
      megaMenuWrapper.classList.remove("show");
    }, 100); // 300ms delay to match the CSS transition
  }

  platformLink.addEventListener("mouseout", handleMouseOut);
  megaMenuWrapper.addEventListener("mouseout", handleMouseOut);
  megaMenuWrapper.addEventListener("mouseover", function () {
    clearTimeout(hideTimeout);
  });
</script>
